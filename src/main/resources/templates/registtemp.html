<!DOCTYPE html>
<html>
<head>
    <title>体温登记</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="description" content="Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description.
">
    <link rel="stylesheet" href="https://cdn.bootcss.com/weui/1.1.3/style/weui.min.css">
    <link rel="stylesheet" href="https://cdn.bootcss.com/jquery-weui/1.2.1/css/jquery-weui.min.css">
    <style type="text/css">
        @import url("css/comon.css");
    </style>

</head>

<body ontouchstart>
<div class="weui-cells weui-cells_form">
    <div class="weui-cell">
        <br>
        <font style="margin-left: 45%" size="4" id="tem">0.0</font><font size="4"> °</font>
        <br>
        <br>
        <br>
        <br>
    </div>

    <div class="weui-cell">
        <div class="weui-cell__hd"><label for="tem1" class="weui-label">度数（整数）</label></div>
        <div class="weui-cell__bd">
            <input class="weui-input" id="tem1" type="text" value="请选择" style="margin-left: 15%" onchange="temchange()">
        </div>
    </div>
    <div class="weui-cell">
        <div class="weui-cell__hd"><label for="tem2" class="weui-label">度数（小数）</label></div>
        <div class="weui-cell__bd">
            <input class="weui-input" id="tem2" type="text" value="请选择" style="margin-left: 15%" onchange="temchange()">
        </div>
    </div>
    <br>
    <br>
    <button class="weui-btn blue-btn" onclick="regist()" id="enter">登记</button>
</div>
<script src="https://cdn.bootcss.com/jquery/1.11.0/jquery.min.js"></script>
<script src="https://cdn.bootcss.com/jquery-weui/1.2.1/js/jquery-weui.min.js"></script>
<script src="https://cdn.bootcss.com/fastclick/1.0.6/fastclick.js"></script>
<script src="js/myUtil.js"></script>
<script>

    var temperature;
    var recordId;

    $(function () {
        recordId = unescape(getQueryString("recordId"));
    })
    $("#tem1").picker({
        title: "温度度数",
        cols: [
            {
                textAlign: 'center',
                values: ['35.0', '36.0', '37.0', '38.0', '39.0', '40.0', '41.0','42.0']
            }
        ],
        onChange: function (p, v, dv) {
            console.log(p, v, dv);
        },
        onClose: function (p, v, d) {
            console.log("close");
        }
    });

    $("#tem2").picker({
        title: "温度度数",
        cols: [
            {
                textAlign: 'center',
                values: [ '0.0','0.1', '0.2', '0.3', '0.4', '0.5', '0.6', '0.7','0.8','0.9']
            }
        ],
        onChange: function (p, v, dv) {
            console.log(p, v, dv);
        },
        onClose: function (p, v, d) {
            console.log("close");
        }
    });

    function temchange() {
        var tem1 = $("#tem1").val().substring(0,$("#tem1").val().length-1);
        var tem2 = $("#tem2").val().substring(2,$("#tem2").val().length);
        var temp = "0.0"
        if($("#tem1").val() == "请选择"){
            temp = "0." + tem2;
        }else if( $("#tem2").val() == "请选择"){
            temp = tem1 + "0";
        }else{
            temp = tem1 + tem2;
        }
        if(temp > "37.2"){
            document.getElementById("tem").style.color = 'red'
        }else{
            document.getElementById("tem").style.color = 'black'
        }
        document.getElementById("tem").innerText = temp;
    }

    function regist() {
        if($("#tem1").val() == "请选择"){
            $.toptip("请选择温度（整数）");
            return;
        }else if($("#tem2").val() == "请选择"){
            $.toptip("请选择温度（小数）");
            return;
        }else{
            var temp = document.getElementById("tem").innerText;
            window.localStorage.setItem("temperature", temp);
            window.location.href = personInforUrl + "?recordId="+recordId + "&temperature="+temp;
        }
    }

    //获取上个页面传过来的参数
    function getQueryString(name) {
        var reg = new RegExp('(^|&)' + name + '=([^&]*)(&|$)', 'i');
        var r = window.location.search.substr(1).match(reg);
        if (r != null) {
            return unescape(r[2]);
        }
        return null;
    }
</script>
</body>
</html>
